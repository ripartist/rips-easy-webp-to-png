<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RIP’s EASY WEBP to PNG Converter</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f4f7;
  padding: 40px;
}
.container {
  max-width: 650px;
  margin: auto;
  background: #fff;
  padding: 30px;
  border-radius: 10px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.1);
}
h1 {
  text-align: center;
  margin-bottom: 5px;
}
.subtitle {
  text-align: center;
  color: #666;
  font-size: 14px;
  margin-bottom: 25px;
}
.drop-zone {
  border: 2px dashed #007bff;
  padding: 30px;
  text-align: center;
  margin-bottom: 20px;
  border-radius: 8px;
  cursor: pointer;
}
.drop-zone.dragover {
  background: #e8f1ff;
}
button {
  background: #007bff;
  color: #fff;
  border: none;
  padding: 12px 20px;
  border-radius: 5px;
  cursor: pointer;
}
button:disabled {
  background: #aaa;
}
.progress {
  margin-top: 15px;
}
#filesList {
  font-size: 14px;
  margin-top: 10px;
}
</style>
</head>

<body>

<div class="container">
  <h1>RIP’s EASY WEBP to PNG Converter</h1>
  <div class="subtitle">Fast • Offline • Batch conversion</div>

  <div class="drop-zone" id="dropZone">
    Drag & drop WEBP files here<br>or click to select
    <input type="file" id="fileInput" accept=".webp" multiple hidden>
  </div>

  <button id="convertBtn" disabled>Convert & Download ZIP</button>

  <div class="progress" id="progress"></div>
  <div id="filesList"></div>
</div>

<script>
const dropZone = document.getElementById('dropZone');
const fileInput = document.getElementById('fileInput');
const convertBtn = document.getElementById('convertBtn');
const progress = document.getElementById('progress');
const filesList = document.getElementById('filesList');

let files = [];

dropZone.onclick = () => fileInput.click();

dropZone.addEventListener('dragover', e => {
  e.preventDefault();
  dropZone.classList.add('dragover');
});

dropZone.addEventListener('dragleave', () => {
  dropZone.classList.remove('dragover');
});

dropZone.addEventListener('drop', e => {
  e.preventDefault();
  dropZone.classList.remove('dragover');
  handleFiles(e.dataTransfer.files);
});

fileInput.addEventListener('change', e => handleFiles(e.target.files));

function handleFiles(selected) {
  files = [...selected].filter(f => f.name.endsWith('.webp'));
  filesList.innerHTML = files.map(f => `• ${f.name}`).join('<br>');
  convertBtn.disabled = files.length === 0;
}

convertBtn.onclick = async () => {
  convertBtn.disabled = true;
  progress.textContent = 'Converting...';

  const zip = new JSZip();
  let completed = 0;

  for (const file of files) {
    const pngBlob = await webpToPng(file);
    zip.file(file.name.replace('.webp', '.png'), pngBlob);
    completed++;
    progress.textContent = `Converted ${completed} / ${files.length}`;
  }

  const zipBlob = await zip.generateAsync({ type: 'blob' });
  const url = URL.createObjectURL(zipBlob);

  const a = document.createElement('a');
  a.href = url;
  a.download = 'RIPs-EASY-WEBP-to-PNG.zip';
  a.click();

  progress.textContent = 'Done ✔ ZIP downloaded';
};

function webpToPng(file) {
  return new Promise(resolve => {
    const img = new Image();
    const reader = new FileReader();

    reader.onload = e => img.src = e.target.result;

    img.onload = () => {
      const canvas = document.createElement('canvas');
      canvas.width = img.width;
      canvas.height = img.height;
      canvas.getContext('2d').drawImage(img, 0, 0);
      canvas.toBlob(blob => resolve(blob), 'image/png');
    };

    reader.readAsDataURL(file);
  });
}
</script>

</body>
</html>
